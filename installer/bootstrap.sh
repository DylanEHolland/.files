#!/usr/bin/env sh
#   Bootstrap a fedora-based system

ROOT_FS="/tmp/chroot";
PKG="dnf -y";
OUTPUT_CENTOS_RELEASE="centos-release.x86_64";
MINIMAL_PACKAGES="
abrt
abrt-addon-ccpp
abrt-addon-kerneloops
abrt-addon-pstoreoops
abrt-addon-python
abrt-addon-vmcore
abrt-addon-xorg
abrt-cli
abrt-console-notification
abrt-dbus
abrt-libs
abrt-python
abrt-tui
acl
aic94xx-firmware
alsa-firmware
alsa-lib
alsa-tools-firmware
at
attr
audit
audit-libs
augeas-libs
authconfig
avahi-autoipd
avahi-libs
basesystem
bash
bash-completion
bc
bind-libs
bind-libs-lite
bind-license
bind-utils
binutils
biosdevname
blktrace
boost-system
boost-thread
bridge-utils
btrfs-progs
bzip2
bzip2-libs
ca-certificates
chkconfig
chrony
coreutils
cpio
cracklib
cracklib-dicts
crda
cronie
cronie-anacron
crontabs
cryptsetup
cryptsetup-libs
curl
cyrus-sasl-lib
cyrus-sasl-plain
dbus
dbus-glib
dbus-libs
dbus-python
desktop-file-utils
device-mapper
device-mapper-event
device-mapper-event-libs
device-mapper-libs
device-mapper-persistent-data
dhclient
dhcp-common
dhcp-libs
diffutils
dmidecode
dmraid
dmraid-events
dnsmasq
dosfstools
dracut
dracut-config-rescue
dracut-network
dyninst
e2fsprogs
e2fsprogs-libs
ebtables
ed
elfutils
elfutils-libelf
elfutils-libs
emacs-filesystem
ethtool
expat
file
file-libs
filesystem
findutils
fipscheck
fipscheck-lib
firewalld
fprintd
fprintd-pam
freetype
fxload
gawk
gdb
gdbm
gdk-pixbuf2
gettext
gettext-libs
glib-networking
glib2
glibc
glibc-common
gmp
gnupg2
gnutls
gobject-introspection
gpgme
gpm-libs
grep
groff-base
grub2
grub2-tools
grubby
gsettings-desktop-schemas
gzip
hardlink
hostname
hunspell
hunspell-en
hunspell-en-GB
hunspell-en-US
hwdata
info
initscripts
iproute
iprutils
iptables
iputils
irqbalance
ivtv-firmware
iw
iwl100-firmware
iwl1000-firmware
iwl105-firmware
iwl135-firmware
iwl2000-firmware
iwl2030-firmware
iwl3160-firmware
iwl3945-firmware
iwl4965-firmware
iwl5000-firmware
iwl5150-firmware
iwl6000-firmware
iwl6000g2a-firmware
iwl6000g2b-firmware
iwl6050-firmware
iwl7260-firmware
iwl7265-firmware
jansson
jasper-libs
jbigkit-libs
json-c
kbd
kbd-legacy
kbd-misc
kernel
kernel
kernel-tools
kernel-tools-libs
kexec-tools
keyutils-libs
kmod
kmod-libs
kpartx
kpatch
krb5-libs
langtable
langtable-data
langtable-python
ledmon
less
libX11
libX11-common
libXau
libacl
libaio
libassuan
libattr
libblkid
libcap
libcap-ng
libcgroup
libcgroup-tools
libcom_err
libconfig
libcroco
libcurl
libdaemon
libdb
libdb-utils
libdrm
libdwarf
libedit
libestr
libffi
libfprint
libgcc
libgcrypt
libgomp
libgpg-error
libgudev1
libidn
libjpeg-turbo
libmnl
libmodman
libmount
libndp
libnetfilter_conntrack
libnfnetlink
libnl
libnl3
libnl3-cli
libpcap
libpciaccess
libpipeline
libpng
libproxy
libpwquality
libreport
libreport-cli
libreport-filesystem
libreport-plugin-mailx
libreport-plugin-rhtsupport
libreport-plugin-ureport
libreport-python
libreport-rhel
libreport-web
libselinux
libselinux-python
libselinux-utils
libsemanage
libsepol
libsoup
libss
libssh2
libsss_idmap
libsss_nss_idmap
libstdc++
libstoragemgmt
libstoragemgmt-python
libsysfs
libtar
libtasn1
libteam
libtiff
libunistring
libusb
libusbx
libuser
libutempter
libuuid
libverto
libxcb
libxml2
libxml2-python
libxslt
linux-firmware
lm_sensors-libs
logrotate
lsof
lsscsi
lua
lvm2
lvm2-libs
lzo
m2crypto
mailx
make
man-db
man-pages
man-pages-overrides
mariadb-libs
mdadm
microcode_ctl
mlocate
mozjs17
mtr
nano
ncurses
ncurses-base
ncurses-libs
net-tools
nettle
newt
newt-python
nspr
nss
nss-softokn
nss-softokn-freebl
nss-sysinit
nss-tools
nss-util
ntpdate
ntsysv
numactl-libs
openldap
openssh
openssh-clients
openssh-server
openssl
openssl-libs
os-prober
p11-kit
p11-kit-trust
pam
parted
passwd
pciutils
pciutils-libs
pcre
perl
perl-Carp
perl-Encode
perl-Exporter
perl-File-Path
perl-File-Temp
perl-Filter
perl-Getopt-Long
perl-HTTP-Tiny
perl-PathTools
perl-Pod-Escapes
perl-Pod-Perldoc
perl-Pod-Simple
perl-Pod-Usage
perl-Scalar-List-Utils
perl-Socket
perl-Storable
perl-Text-ParseWords
perl-Time-HiRes
perl-Time-Local
perl-constant
perl-libs
perl-macros
perl-parent
perl-podlators
perl-threads
perl-threads-shared
pinentry
pinfo
pkgconfig
plymouth
plymouth-core-libs
plymouth-scripts
pm-utils
policycoreutils
polkit
polkit-pkla-compat
popt
postfix
ppp
procps-ng
psacct
pth
pyOpenSSL
pygobject2
pygobject3-base
pygpgme
pyliblzma
python
python-augeas
python-backports
python-backports-ssl_match_hostname
python-chardet
python-configobj
python-dateutil
python-decorator
python-dmidecode
python-ethtool
python-gudev
python-hwdata
python-iniparse
python-kitchen
python-libs
python-lxml
python-magic
python-perf
python-pycurl
python-pyudev
python-requests
python-rhsm
python-setuptools
python-six
python-slip
python-slip-dbus
python-urlgrabber
python-urllib3
pyxattr
qrencode-libs
quota
quota-nls
rdate
rdma
readline
redhat-access-insights
redhat-indexhtml
redhat-logos
redhat-release-server
redhat-support-lib-python
redhat-support-tool
rfkill
rhn-check
rhn-client-tools
rhn-setup
rhnlib
rhnsd
rng-tools
rootfiles
rpm
rpm-build-libs
rpm-libs
rpm-python
rsync
rsyslog
satyr
scl-utils
sed
selinux-policy
selinux-policy-targeted
setserial
setup
setuptool
sg3_utils-libs
sgpio
shadow-utils
shared-mime-info
slang
smartmontools
snappy
sos
sqlite
sssd-client
strace
subscription-manager
sudo
sysstat

systemd
systemd-libs
systemd-python
systemd-sysv
systemtap-runtime
sysvinit-tools
tar
tcp_wrappers
tcp_wrappers-libs
tcpdump
tcsh
teamd
time
traceroute
trousers
tuned
tzdata
unzip
usb_modeswitch
usb_modeswitch-data
usbutils
usermode
ustr
util-linux
vim-common
vim-enhanced
vim-filesystem
vim-minimal
virt-what
wget
which
words
wpa_supplicant
xdg-utils
xfsdump
xfsprogs
xmlrpc-c
xmlrpc-c-client
xz
xz-libs
yajl
yum
yum-langpacks
yum-metadata-parser
yum-rhn-plugin
yum-utils
zip
zlib
";

create_root_fs() {
    if ! [ -d $ROOT_FS ]; then
        mkdir -pv $ROOT_FS && return 0;
    else
        echo "Directory exists!" && return 1;
    fi;

    return 1
}

if create_root_fs; then
    rpm --root=$ROOT_FS --initdb;
    $PKG --installroot=$ROOT_FS --releasever=/ update;
    $PKG --installroot=$ROOT_FS --releasever=/ install $OUTPUT_CENTOS_RELEASE;
    $PKG --installroot=$ROOT_FS install basesystem filesystem gettext;
    $PKG --installroot=$ROOT_FS install dnf yum-metadata-parser yum-utils yum-plugin-fastestmirror;
    for pack in $MINIMAL_PACKAGES; 
    do
        $PKG --installroot=$ROOT_FS install $pack;
    done;


    echo "==============";
    echo "    Success   ";
    echo "==============";
else
    echo "Something went wrong";
fi;